---
title: "Architecture & Data Flow"
description: "Visualize uBO Scope's architecture: how the browser extension background scripts use the webRequest API to capture and categorize network requests, how data is relayed to the popup UI, and how session state is managed. Includes an annotated mermaid diagram mapping the extension’s main flows."
---

# Architecture & Data Flow

## Visualizing uBO Scope's Inner Workings

uBO Scope is designed to transparently monitor and reveal the network requests initiated by the webpages you visit. Understanding its architecture and data flow is key to appreciating how it delivers precise, real-time insights into third-party connections — empowering you to make informed privacy decisions with confidence.

This page guides you through uBO Scope's internal operation, focusing on ***how the browser extension's background scripts leverage the webRequest API to capture, categorize, and relay network request data to the popup UI***, all while managing session state effectively.

---

### Why This Matters to You

If you have ever wondered how uBO Scope gathers and presents the live data you see in its popup panel, this section pulls back the curtain. You will learn:

- How network request events are captured continuously in the background
- How requests are categorized as allowed, stealth-blocked, or blocked
- How data is updated and saved during your browsing session
- How the popup UI retrieves this data to render the details you rely on

Armed with this understanding, you can confidently interpret uBO Scope's outputs and troubleshoot any issues that may arise in capturing network activity.

---

## How uBO Scope Works: Core Components & Data Flow

At its heart, uBO Scope consists of two main parts:

1. **Background Scripts** — The engine that listens to all network activity using the browser's `webRequest` API, processes this information, and maintains session state.
2. **Popup UI** — The interface you interact with, which requests data from the background and displays categorized network connections.


### 1. Background Scripts: The Watchful Network Observer

- **Continuous Monitoring**: Using the `webRequest` API, the background scripts listen for key events tied to each network request:
  - **`onBeforeRedirect`** to detect redirects
  - **`onErrorOccurred`** to catch failed requests
  - **`onResponseStarted`** to note successful responses

- **Capturing and Categorizing Network Requests**: Each network event captures details such as URL, request type, tab ID, and event outcome (redirect, error, success). These details are placed in a temporary journal.

- **Batch Processing**: To optimize performance, the background script processes requests in batches every second, updating the session data with outcomes classified into three categories:
  - **Allowed:** Requests that succeeded
  - **Stealth-blocked:** Redirects that indicate potentially hidden blocking
  - **Blocked:** Requests that failed

- **Session Management**: The background logic maintains a `session` map associating tab IDs with detailed connection summaries, including domain and hostname counts. This state is serialized and saved in the browser's session storage to ensure persistence during your browsing session.

- **Badge Updates**: After processing, the script updates the toolbar icon badge to show the count of distinct allowed third-party domains, offering an at-a-glance privacy indicator.

- **Tab Lifecycle Handling**: It listens for tab closures to clean up session data appropriatetly, ensuring memory-efficiency and accuracy.


### 2. Popup UI: Your Real-Time Network Insight Panel

- When you open uBO Scope’s popup, the UI sends a message to the background script requesting the current tab's network request data.

- The background script responds with serialized tab data containing categorized connections.

- The popup deserializes and renders this data into intuitive sections:
  - Not blocked
  - Stealth-blocked
  - Blocked

- Domains are displayed with counts, and the popup dynamically populates the UI to give you granular insight about the third-party connections on the active tab.

---

## Detailed Data Flow Diagram

Below is an annotated Mermaid diagram illustrating the extension’s primary data flows and architecture components.

```mermaid
flowchart TD

  subgraph Browser
    direction TB
    WebRequestAPI["webRequest API Events"]
    TabManager["Browser Tabs"]
  end

  subgraph Extension_Background ["uBO Scope Background Scripts"]
    direction TB
    ReqQueue["Network Request Journal (Queue)"]
    ProcessTimer["Batch Processor (every 1s)"]
    SessionData["Session State (session storage)"]
    BadgeUpdater["Toolbar Badge Updater"]

    WebRequestAPI -->|onBeforeRedirect / onErrorOccurred / onResponseStarted| ReqQueue
    ReqQueue --> ProcessTimer
    ProcessTimer --> SessionData
    ProcessTimer --> BadgeUpdater
    TabManager -->|tabRemoved| SessionData
  end

  subgraph PopupUI ["Extension Popup UI"]
    direction TB
    PopupPanel["Popup Renderer"]
    MessageHandler["Messaging Interface"]
  end

  PopupPanel -->|request current tab data| MessageHandler
  MessageHandler --> SessionData
  SessionData -->|serialized tab data| MessageHandler
  MessageHandler --> PopupPanel

  %% Legend
  classDef browser fill:#f0f8ff,stroke:#38a,stroke-width:1.5px;
  classDef background fill:#dff0d8,stroke:#3c763d,stroke-width:1.5px;
  classDef popup fill:#d9edf7,stroke:#31708f,stroke-width:1.5px;

  class Browser,browser
  class Extension_Background,background
  class PopupUI,popup
```

---

## Practical Example: From Network Request to Popup Display

Consider visiting a webpage that loads resources from multiple third-party servers:

1. **Network request occurs:** The browser issues a request to `https://tracker.example.com/script.js`.

2. **Background intercepts:** The request triggers a `webRequest.onResponseStarted` event, queued for processing.

3. **Categorization:** On batch processing, this request is classified as **allowed** (successful).

4. **Session state update:** The domain `tracker.example.com` is recorded under allowed domains for this tab.

5. **Badge update:** The badge on uBO Scope’s toolbar icon increments to reflect this allowed connection.

6. **Popup opens:** When you open the popup UI while on this tab, a request is sent to retrieve session details.

7. **Data retrieval and display:** The popup receives and renders the domain `tracker.example.com` under the "not blocked" section, with an associated count.

You now have clear, actionable visibility into which third-party servers your browser communicated with — providing valuable context to assess your privacy posture.

---

## Best Practices & Troubleshooting Tips

- **Ensure permissions:** For correct monitoring, verify uBO Scope has the necessary permissions (`webRequest`, `activeTab`, `storage`) granted during installation.

- **Tabs without data:** If the popup displays "NO DATA," it typically means no network requests have been captured yet for the active tab or the tab was recently opened.

- **Persistence scope:** Session data is maintained only for the browser session. Closing the browser clears session data.

- **Handling redirects:** Redirected requests are tracked and categorized separately to reveal potentially stealthy blocking scenarios.

- **Browser compatibility:** uBO Scope relies on the browser exposing the full network lifecycle via the `webRequest` API. Some browser environments may limit such API access, affecting data completeness.

- **Extension updates:** Minimal updates are planned; however, staying on the latest extension version ensures you benefit from the most accurate data processing logic.

---

## Next Steps

- Explore the [What is uBO Scope?](/overview/introduction-business-value/what-is-ubo-scope) page to understand the product’s core value.
- Learn how to interpret the live data in the popup via [Interpreting the Badge Counter and Popup Panel](/guides/getting-started-usage/interpret-badge-and-popup).
- Get hands-on with setup via [Installing uBO Scope](/getting-started/installation-setup/installing-ubo-scope).

---

<u>With the technical foundations mapped out, you are now equipped to fully leverage uBO Scope’s capabilities to uncover and understand the browser’s network activity with precision and ease.</u>
