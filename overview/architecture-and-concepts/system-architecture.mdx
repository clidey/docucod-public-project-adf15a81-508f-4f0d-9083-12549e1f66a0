---
title: "System Architecture"
description: "Explore the extension’s architecture, from background network monitoring to popup data display. Visual diagrams (mermaid) convey how browser APIs, session storage, and popup interfaces interact to deliver transparent network insights to users."
---

# System Architecture

Discover how uBO Scope orchestrates its components to deliver transparent, real-time insights into network connections made by your browser. This page guides you through the extension's architecture from the background monitoring processes all the way to the user-facing popup display, illustrating how browser APIs, session storage, and UI layers collaborate seamlessly.

---

## Why Explore uBO Scope's Architecture?

Understanding the system architecture is vital for users who want to gain confidence in how uBO Scope operates behind the scenes to accurately gather and present network connection data. It clarifies how the extension collects information independent of web content blockers, maintains session persistence, and efficiently communicates data to the popup interface.

---

## Architecture Overview

At its core, uBO Scope relies on the browser's `webRequest` API to monitor every network request initiated by web pages. The extension’s architecture is split into three primary layers:

- **Background Network Monitoring:** A persistent background script captures all network events and classifies requests.
- **Session Data Management:** Information is stored and managed in session storage to maintain real-time state of network connections.
- **Popup Interface:** The front-end popup presents concise, categorized summaries to users.

This layered approach guarantees that uBO Scope provides an accurate, timely snapshot of your browsing network activity, preserving essential context across tab sessions.

### Key Components

- **Background Script:** Acts as the brain, listening to network events such as redirects, responses, and errors using the `webRequest` API.
- **Session Storage:** Temporarily holds network request details, ensuring persistence throughout the browsing session.
- **Public Suffix List Support:** Utilized to correctly parse domains versus subdomains, enhancing grouping accuracy.
- **Popup Interface:** Fetches data from the background to display categorized connection lists on demand.

---

## How It Works: The User's Journey

1. **Monitoring Starts:** When a user navigates to a webpage, the background script initiates tracking for every network request triggered by that page.
2. **Classification & Aggregation:** Each network request is classified into one of three outcomes:
   - **Allowed:** Successful connections that were loaded.
   - **Stealth-blocked:** Requests that were silently blocked without direct notification.
   - **Blocked:** Requests explicitly blocked, either through content blockers or network errors.

   These outcomes are aggregated by domain and hostname, providing granular detail.
3. **State Management:** The contextual data for each browser tab is stored in a session-level map that persists as long as the tab remains open.
4. **User Access:** When the user clicks the uBO Scope icon, the popup interface requests the current tab's data and presents it in an intuitive format.

---

## Detailed Workflow Diagram

```mermaid
flowchart TD

  subgraph Background Layer
    WB["webRequest Listeners"] --> PReqProc["Process Network Requests"]
    PReqProc --> SessStore["Update Session Storage"]
    SessStore --> BadgeUpdate["Update Browser Badge Count"]
  end

  subgraph Session Storage
    SessStore --> TabMap["TabID to Detail Map"]
    TabMap --> DomainClassification["Allowed / Stealth / Blocked Domains"]
  end

  subgraph UI Layer
    UserClick["User Clicks Extension Icon"] --> MsgSend["Popup Sends Message: getTabData"]
    MsgSend --> BgResponse["Background Sends Serialized Tab Data"]
    BgResponse --> PopupRender["Popup Renders Domain Lists"]
  end

  WB -.->|Monitors requests for all tabs| PReqProc
  PopupRender -.->|Displays categorized connection data| User

  %% Style Definitions
  classDef layer fill:#e3f2fd,stroke:#1565c0,stroke-width:2px,rounded corners;
  class Background Layer,Session Storage,UI Layer layer;

  class User user-icon;

```

---

## Component Roles Explained

### Background Script: Your Invisible Network Watcher

- **Real-time Monitoring:** Captures all network events, including redirects, errors, and successful responses, thanks to `webRequest` listeners.
- **Outcome Classification:** Assigns each request to categories – allowed, stealth, or blocked – based on network success, errors, or redirects.
- **Tab-specific Context:** Stores connection details in a map keyed by tab IDs, resetting data for main frame navigations to ensure accurate session context.
- **Badge Management:** Updates the browser action badge with the count of allowed third-party domains per tab, giving an at-a-glance indicator.

### Session Storage: The Resilient State Keeper

- Persists the tab's connection data in browser session storage, enabling quick recovery or retrieval without data loss on navigation.
- Maintains mapping of domains and hostnames categorized by their outcome, supporting rich UI reporting.

### Popup Interface: Your Transparent Window

- Upon activation, requests the tab-specific data from the background script.
- Deserializes the data and renders it into grouped lists (allowed, stealth, blocked) showing domain names and request counts.
- Uses Unicode conversion to display internationalized domain names cleanly.

---

## Practical Tips & Best Practices

- **Browser Compatibility:** uBO Scope utilizes the `webRequest` API, which is fully supported in Chromium and Firefox-based browsers, ensuring wide reach.
- **Session Persistence:** Data is maintained as long as tabs are open—closing a tab clears its stored data automatically.
- **Understanding Badge Counts:** The badge number reflects distinct third-party domains connected successfully, not raw request counts.
- **Stealth Blocking Insight:** Requests silently blocked (often by stealthy content blockers) appear separately, helping to better understand your network environment.

---

## Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Network Data Availability">
<Accordion title="Popup Shows ‘NO DATA’ or Blank">
This indicates that the popup could not retrieve network data for the active tab. Possible causes include:
- Network data has not been collected yet (e.g., freshly opened tab).
- Tab has no recorded network activity.
- Communication between popup and background script failed.

**Resolution:** Try refreshing the tab or ensuring the extension is enabled and active.
</Accordion>
<Accordion title="Badge Number Not Updating">
The badge count may not update due to timing delays or lack of new network requests.

**Resolution:** Wait a few seconds after page load, or reload the tab to force new requests that trigger updates.
</Accordion>
<Accordion title="Data Does Not Reflect Blocker Changes Immediately">
Since uBO Scope records network outcomes asynchronously, some delay might occur.

**Resolution:** Give a moment after changing blocker settings and refresh the page for accurate data.
</Accordion>
</AccordionGroup>

---

## Next Steps

- To get started with uBO Scope, proceed to the [Installing on Your Browser](https://github.com/gorhill/uBO-Scope/blob/main/getting_started/installation_and_setup/installing_on_your_browser.mdx) guide.
- For a hands-on guide to interpreting connection data, see [Reading the Popup: What Do the Numbers Mean?](https://github.com/gorhill/uBO-Scope/blob/main/guides/analyzing-traffic/interpreting-popup.mdx).
- Dive deeper into important terminology and inner workings at [Key Concepts & Terminology](https://github.com/gorhill/uBO-Scope/blob/main/overview/architecture-and-concepts/core-terms.mdx).

---

## Additional Resources

- [uBO Scope Product Overview](https://github.com/gorhill/uBO-Scope/blob/main/overview/introduction-and-value/product-overview.mdx)
- [Understanding Core Benefits of uBO Scope](https://github.com/gorhill/uBO-Scope/blob/main/overview/introduction-and-value/core-benefits.mdx)
- Official Source Code Repository: [https://github.com/gorhill/uBO-Scope](https://github.com/gorhill/uBO-Scope)

---